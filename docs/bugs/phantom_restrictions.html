

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Phantom restrictions bug &mdash; Next Search Catalog 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/override.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Next Search Catalog
          

          
            
            <img src="../_static/next.grey.small.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../history.html">History of Next Search Catalog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../emergency.html">Emergency procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrades/2005/index.html">Koha 20.05 training</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Next Search Catalog</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Phantom restrictions bug</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/bugs/phantom_restrictions.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="phantom-restrictions-bug">
<h1>Phantom restrictions bug<a class="headerlink" href="#phantom-restrictions-bug" title="Permalink to this headline">¶</a></h1>
<p>There is a bug in Koha that is creating “phantom” restrictions.</p>
<p>You can identify these restrictions when you open a borrower’s account and see a message that says there’s a restriction but when you click on the “View restrictions” button, there are no restrictions listed.</p>
<div class="section" id="this-is-what-the-problem-looks-like">
<h2>This is what the problem looks like:<a class="headerlink" href="#this-is-what-the-problem-looks-like" title="Permalink to this headline">¶</a></h2>
<p><img alt="Phantom restrictions - overview of problem" src="../_images/phantom_restrictions_0010.png" /></p>
</div>
<div class="section" id="this-is-the-solution">
<h2>This is the solution:<a class="headerlink" href="#this-is-the-solution" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>In the restrictions tab, click on “Add manual restriction”</li>
</ol>
<blockquote>
<div><img alt="Phantom restrictions - Solution step 1" src="../_images/phantom_restrictions_0020.png" /></div></blockquote>
<ol class="arabic simple" start="2">
<li>Click on the “Add restriction” button (you can, optionally, make a note about the restriction)</li>
</ol>
<blockquote>
<div><img alt="Phantom restrictions - Solution step 2" src="../_images/phantom_restrictions_0030.png" /></div></blockquote>
<ol class="arabic simple" start="3">
<li>Then click on “Remove” restriction</li>
</ol>
<blockquote>
<div><img alt="Phantom restrictions - Solution step 3" src="../_images/phantom_restrictions_0040.png" /></div></blockquote>
<ol class="arabic simple" start="4">
<li>Click “Yes” in the pop-up window to confirm that you do want to remove the restriction</li>
</ol>
<blockquote>
<div><img alt="Phantom restrictions - Solution step 4" src="../_images/phantom_restrictions_0050.png" /></div></blockquote>
<ol class="arabic simple" start="5">
<li>All restrictions should now be gone</li>
</ol>
<blockquote>
<div><img alt="Phantom restrictions - Solution step 5" src="../_images/phantom_restrictions_0060.png" /></div></blockquote>
</div>
<div class="section" id="what-causes-this-problem">
<h2>What causes this problem:<a class="headerlink" href="#what-causes-this-problem" title="Permalink to this headline">¶</a></h2>
<p>We believe this is caused by Koha community bug <a class="reference external" href="https://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=26208" target="_blank">26208</a></p>
<p>For the example in the screenshots above:</p>
<ul>
<li><p class="first">The borrower’s account was blocked on March 1 when two of the items they had checked out were overdue for more than 35 days and they were sent a “Library account blocked” email.</p>
<p><img alt="Phantom restrictions - Solution step 4" src="../_images/phantom_restrictions_0110.png" /></p>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first">The two items were renewed on March 2.</p>
<p><img alt="Phantom restrictions - Solution step 5" src="../_images/phantom_restrictions_0130.png" /></p>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first">The restriction was removed from the table in the database called “borrower_debarments” but it was not removed from the table called “borrowers.”  This is a known bug in Koha and the Koha community is working to solve the problem.  In fact, a patch has been created.  If possible the patch will be added to our system as soon as possible.  It is possible, however, that we may have to wait for the next upgrade for this problem to be permanently fixed.</p>
<p>The reason that the solution listed above works is because, when you add the new restriction to an account, Koha has to update both tables - borrowers and borrowers_debarments.  When Koha updates those tables, the process of adding and removing debarments recognizes that there is a discrepancy between the two tables and fixes it.  That way when you take off the new restriction, the phantom restriction is no longer there.</p>
<p><img alt="Phantom restrictions - Solution step 4" src="../_images/phantom_restrictions_0140.png" /></p>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Northeast Kansas Library System

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'1.0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>